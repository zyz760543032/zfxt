{"remainingRequest":"D:\\project\\test\\front\\cli\\payment-demo\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\test\\front\\cli\\payment-demo\\src\\views\\Orders.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\test\\front\\cli\\payment-demo\\src\\views\\Orders.vue","mtime":1637252445002},{"path":"D:\\project\\test\\front\\cli\\payment-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\test\\front\\cli\\payment-demo\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\test\\front\\cli\\payment-demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\test\\front\\cli\\payment-demo\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgb3JkZXJJbmZvQXBpIGZyb20gIi4uL2FwaS9vcmRlckluZm8iDQppbXBvcnQgd3hQYXlBcGkgZnJvbSAiLi4vYXBpL3d4UGF5Ig0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGxpc3Q6IFtdLCAvL+iuouWNleWIl+ihqA0KICAgICAgcmVmdW5kRGlhbG9nVmlzaWJsZTogZmFsc2UsIC8v6YCA5qy+5by556qXDQogICAgICBvcmRlck5vOiAnJywgLy/pgIDmrL7orqLljZXlj7cNCiAgICAgIHJlYXNvbjogJycsIC8v6YCA5qy+5Y6f5ZugLA0KICAgICAgcmVmdW5kU3VibWl0QnRuRGlzYWJsZWQ6IGZhbHNlLCAvL+mYsuatoumHjeWkjeaPkOS6pA0KICAgIH07DQogIH0sDQoNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLnNob3dPcmRlckxpc3QoKQ0KICB9LA0KDQogIG1ldGhvZHM6IHsNCg0KICAgIC8v5pi+56S66K6i5Y2V5YiX6KGoDQogICAgc2hvd09yZGVyTGlzdCgpew0KICAgICAgb3JkZXJJbmZvQXBpLmxpc3QoKS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICB0aGlzLmxpc3QgPSByZXNwb25zZS5kYXRhLmxpc3Q7DQogICAgICB9KTsNCiAgICB9LA0KICAgIA0KICAgIC8v55So5oi35Y+W5raI6K6i5Y2VDQogICAgY2FuY2VsKG9yZGVyTm8pew0KICAgICAgd3hQYXlBcGkuY2FuY2VsKG9yZGVyTm8pLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzcG9uc2UubWVzc2FnZSkNCiAgICAgICAgLy/liLfmlrDorqLljZXliJfooagNCiAgICAgICAgdGhpcy5zaG93T3JkZXJMaXN0KCkNCiAgICAgIH0pDQogICAgfSwNCg0KICAgIC8v6YCA5qy+5a+56K+d5qGGDQogICAgcmVmdW5kKG9yZGVyTm8pew0KICAgICAgdGhpcy5yZWZ1bmREaWFsb2dWaXNpYmxlID0gdHJ1ZQ0KICAgICAgdGhpcy5vcmRlck5vID0gb3JkZXJObw0KICAgIH0sDQoNCiAgICAvL+WFs+mXremAgOasvuWvueivneahhg0KICAgIGNsb3NlRGlhbG9nKCl7DQogICAgICBjb25zb2xlLmxvZygnY2xvc2UuLi4uLi4uLi4uLi4uLi4uLicpDQogICAgICB0aGlzLnJlZnVuZERpYWxvZ1Zpc2libGUgPSBmYWxzZQ0KICAgICAgLy/ov5jljp/nu4Tku7bnirbmgIENCiAgICAgIHRoaXMub3JkZXJObyA9ICcnDQogICAgICB0aGlzLnJlYXNvbiA9ICcnDQogICAgICB0aGlzLnJlZnVuZFN1Ym1pdEJ0bkRpc2FibGVkID0gZmFsc2UNCiAgICB9LA0KDQogICAgLy/noa7orqTpgIDmrL4NCiAgICB0b1JlZnVuZHMoKXsNCiAgICAgIHRoaXMucmVmdW5kU3VibWl0QnRuRGlzYWJsZWQgPSB0cnVlIC8v56aB55So5oyJ6ZKu77yM6Ziy5q2i6YeN5aSN5o+Q5LqkDQogICAgICB3eFBheUFwaS5yZWZ1bmRzKHRoaXMub3JkZXJObywgdGhpcy5yZWFzb24pLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICBjb25zb2xlLmxvZygncmVzcG9uc2UnLCByZXNwb25zZSkNCiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpDQogICAgICAgIHRoaXMuc2hvd09yZGVyTGlzdCgpDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["Orders.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Orders.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"bg-fa of\">\r\n    <section id=\"index\" class=\"container\">\r\n      <header class=\"comm-title\">\r\n        <h2 class=\"fl tac\">\r\n          <span class=\"c-333\">订单列表</span>\r\n        </h2>\r\n      </header>\r\n      <el-table :data=\"list\" border style=\"width: 100%\">\r\n        <el-table-column type=\"index\" width=\"50\"></el-table-column>\r\n        <el-table-column prop=\"orderNo\" label=\"订单编号\" width=\"230\" ></el-table-column>\r\n        <el-table-column prop=\"title\" label=\"订单标题\"></el-table-column>\r\n        <el-table-column prop=\"totalFee\" label=\"订单金额\">\r\n          <template slot-scope=\"scope\">\r\n              {{scope.row.totalFee / 100}} 元\r\n          </template>  \r\n        </el-table-column>\r\n        <el-table-column label=\"订单状态\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag v-if=\"scope.row.orderStatus === '未支付'\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '支付成功'\" type=\"success\">\r\n              {{ scope.row.orderStatus }}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '超时已关闭'\" type=\"warning\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '用户已取消'\" type=\"info\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '退款中'\" type=\"danger\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '已退款'\" type=\"info\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"创建时间\"></el-table-column>\r\n        <el-table-column label=\"操作\" width=\"100\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button v-if=\"scope.row.orderStatus === '未支付'\" type=\"text\" @click=\"cancel(scope.row.orderNo)\">取消</el-button>\r\n            <el-button v-if=\"scope.row.orderStatus === '支付成功'\" type=\"text\" @click=\"refund(scope.row.orderNo)\">退款</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </section>\r\n\r\n    <!-- 退款对话框 -->\r\n   <el-dialog\r\n      :visible.sync=\"refundDialogVisible\"\r\n      @close=\"closeDialog\"\r\n      width=\"350px\"\r\n      center>\r\n      <el-form>\r\n        <el-form-item label=\"退款原因\">\r\n          <el-select v-model=\"reason\" placeholder=\"请选择退款原因\">\r\n            <el-option label=\"不喜欢\" value=\"不喜欢\"></el-option>\r\n            <el-option label=\"买错了\" value=\"买错了\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"toRefunds()\" :disabled=\"refundSubmitBtnDisabled\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport orderInfoApi from \"../api/orderInfo\"\r\nimport wxPayApi from \"../api/wxPay\"\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [], //订单列表\r\n      refundDialogVisible: false, //退款弹窗\r\n      orderNo: '', //退款订单号\r\n      reason: '', //退款原因,\r\n      refundSubmitBtnDisabled: false, //防止重复提交\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.showOrderList()\r\n  },\r\n\r\n  methods: {\r\n\r\n    //显示订单列表\r\n    showOrderList(){\r\n      orderInfoApi.list().then((response) => {\r\n        this.list = response.data.list;\r\n      });\r\n    },\r\n    \r\n    //用户取消订单\r\n    cancel(orderNo){\r\n      wxPayApi.cancel(orderNo).then(response => {\r\n        this.$message.success(response.message)\r\n        //刷新订单列表\r\n        this.showOrderList()\r\n      })\r\n    },\r\n\r\n    //退款对话框\r\n    refund(orderNo){\r\n      this.refundDialogVisible = true\r\n      this.orderNo = orderNo\r\n    },\r\n\r\n    //关闭退款对话框\r\n    closeDialog(){\r\n      console.log('close.................')\r\n      this.refundDialogVisible = false\r\n      //还原组件状态\r\n      this.orderNo = ''\r\n      this.reason = ''\r\n      this.refundSubmitBtnDisabled = false\r\n    },\r\n\r\n    //确认退款\r\n    toRefunds(){\r\n      this.refundSubmitBtnDisabled = true //禁用按钮，防止重复提交\r\n      wxPayApi.refunds(this.orderNo, this.reason).then(response => {\r\n        console.log('response', response)\r\n        this.closeDialog()\r\n        this.showOrderList()\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>"]}]}